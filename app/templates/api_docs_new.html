<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WxAuto HTTP API 文档</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }

        /* 顶部导航栏 */
        .navbar {
            background-color: #07C160;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1050;
            height: 60px;
        }
        .navbar-brand {
            color: white;
            font-weight: bold;
        }

        /* 主容器 - 第一层布局 */
        .main-container {
            display: flex;
            height: 100vh;
            padding-top: 60px; /* 为固定导航栏留出空间 */
        }

        /* 左侧导航容器 */
        .sidebar-container {
            width: 280px;
            background: white;
            border-right: 1px solid #e9ecef;
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-container.collapsed {
            width: 60px;
        }

        /* 导航栏切换按钮 */
        .sidebar-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #07C160;
            color: white;
            border: none;
            border-radius: 4px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .sidebar-toggle:hover {
            background: #06a050;
        }

        /* 导航内容 */
        .sidebar-content {
            padding: 15px;
        }

        .sidebar-container.collapsed .sidebar-content {
            padding: 15px 5px;
        }

        .sidebar-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #495057;
            transition: opacity 0.3s;
        }

        .sidebar-container.collapsed .sidebar-title {
            opacity: 0;
            height: 0;
            margin: 0;
            overflow: hidden;
        }

        /* 导航链接 */
        .nav-link {
            color: #495057;
            padding: 8px 12px;
            border-radius: 4px;
            margin: 2px 0;
            transition: all 0.3s;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .nav-link i {
            margin-right: 8px;
            width: 16px;
            text-align: center;
        }

        .sidebar-container.collapsed .nav-link {
            justify-content: center;
            padding: 8px;
        }

        .sidebar-container.collapsed .nav-link span {
            display: none;
        }

        .nav-link:hover {
            background-color: #e9ecef;
            color: #07C160;
            transform: translateX(5px);
        }

        .nav-link.active {
            background-color: #07C160;
            color: white;
            font-weight: bold;
            transform: translateX(8px);
            box-shadow: 0 2px 8px rgba(7, 193, 96, 0.3);
            border-left: 4px solid #05a050;
        }

        .nav-link.active i {
            color: #ffffff;
            font-weight: bold;
        }

        /* 右侧内容容器 */
        .content-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* 文档说明区域 */
        .doc-overview {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 50px;
            position: relative;
        }

        /* 章节分割线 */
        .doc-overview:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #e9ecef, transparent);
        }

        /* API端点区域 */
        .api-endpoints {
            display: block; /* 始终显示，允许连续滚动 */
            margin-bottom: 50px;
            position: relative;
        }

        /* API端点区域分割线 */
        .api-endpoints:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #07C160, transparent);
        }

        /* API端点容器 - 第二层布局 */
        .api-endpoint-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid #e9ecef;
        }

        .api-endpoint-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e9ecef;
            font-weight: bold;
            color: #495057;
        }

        .api-endpoint-content {
            display: flex;
            min-height: 400px;
        }

        /* 左侧文档说明 */
        .api-doc-section {
            flex: 1;
            padding: 20px;
            border-right: 1px solid #e9ecef;
            overflow-y: auto;
        }

        /* 右侧测试工具 */
        .api-test-section {
            flex: 1;
            padding: 20px;
            background: #f8f9fa;
            overflow-y: auto;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar-container {
                width: 100%;
                height: auto;
                max-height: 200px;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .api-endpoint-content {
                flex-direction: column;
            }
            
            .api-doc-section {
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
        }

        /* 移动端侧边栏覆盖层 */
        @media (max-width: 768px) {
            .sidebar-container {
                position: fixed;
                top: 60px;
                left: -100%;
                width: 280px;
                height: calc(100vh - 60px);
                max-height: none;
                transition: left 0.3s ease;
                z-index: 1040;
            }

            .sidebar-container.show {
                left: 0;
            }

            .sidebar-overlay {
                position: fixed;
                top: 60px;
                left: 0;
                width: 100%;
                height: calc(100vh - 60px);
                background: rgba(0, 0, 0, 0.5);
                z-index: 1030;
                display: none;
            }

            .sidebar-overlay.show {
                display: block;
            }

            .content-container {
                width: 100%;
                padding: 15px;
            }
        }

        /* 通用样式 */
        .method-badge {
            font-size: 0.75em;
            padding: 3px 6px;
            border-radius: 3px;
            margin-right: 8px;
        }
        .method-get { background-color: #28a745; color: white; }
        .method-post { background-color: #007bff; color: white; }
        .method-put { background-color: #ffc107; color: black; }
        .method-delete { background-color: #dc3545; color: white; }

        .version-badge {
            font-size: 0.65em;
            padding: 2px 5px;
            border-radius: 2px;
            margin-left: 8px;
        }
        .version-basic { background-color: #07C160; color: white; }
        .version-plus { background-color: #1E88E5; color: white; }

        /* 统计卡片样式 */
        .stat-card {
            background: linear-gradient(135deg, #07C160, #05a050);
            color: white;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }
        .stat-number {
            font-size: 1.6em;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            margin: 8px 0;
            overflow-x: auto;
            font-size: 0.85em;
            font-family: 'Courier New', monospace;
        }

        /* API测试工具样式 */
        .api-tester {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
        }

        .tester-header {
            background: #07C160;
            color: white;
            padding: 8px 12px;
            margin: -15px -15px 15px -15px;
            border-radius: 6px 6px 0 0;
            font-weight: bold;
            font-size: 0.9em;
        }

        .tester-body .form-label {
            font-weight: 600;
            font-size: 0.85em;
            margin-bottom: 4px;
        }

        .tester-body .form-control,
        .tester-body .form-select {
            font-size: 0.85em;
            padding: 6px 10px;
        }

        .tester-body textarea {
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
        }

        .test-button {
            background: #07C160;
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
        }

        .test-button:hover {
            background: #06a050;
        }

        .test-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .response-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #dee2e6;
        }

        .response-header {
            font-weight: 600;
            font-size: 0.85em;
            margin-bottom: 8px;
            color: #495057;
        }

        .response-content {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .response-success {
            border-color: #28a745;
            background: #f0f8f0;
        }

        .response-error {
            border-color: #dc3545;
            background: #f8f0f0;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <button class="btn btn-outline-light d-md-none me-2" type="button" id="sidebarToggle">
                <i class="bi bi-list"></i>
            </button>
            <a class="navbar-brand" href="/">
                <i class="bi bi-chat-dots-fill"></i> WxAuto HTTP API 文档
            </a>
            <div class="navbar-nav ms-auto">
                <span class="text-white-50">WxAuto HTTP API v2.0</span>
            </div>
        </div>
    </nav>

    <!-- 移动端侧边栏遮罩 -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- 主容器 -->
    <div class="main-container">
        <!-- 左侧导航容器 -->
        <div class="sidebar-container" id="sidebarContainer">
            <button class="sidebar-toggle d-none d-md-block" id="sidebarToggleDesktop">
                <i class="bi bi-list"></i>
            </button>
            <div class="sidebar-content">
                <h5 class="sidebar-title"><i class="bi bi-list"></i> <span>目录</span></h5>
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#overview" data-section="overview">
                        <i class="bi bi-book"></i><span>概述</span>
                    </a>
                    <a class="nav-link" href="#features" data-section="features">
                        <i class="bi bi-star"></i><span>功能特性</span>
                    </a>
                    <a class="nav-link" href="#versions" data-section="versions">
                        <i class="bi bi-layers"></i><span>版本对比</span>
                    </a>
                    <a class="nav-link" href="#auth" data-section="auth">
                        <i class="bi bi-shield-lock"></i><span>认证方式</span>
                    </a>
                    <a class="nav-link" href="#basic-apis" data-section="basic-apis">
                        <i class="bi bi-gear"></i><span>基础功能</span>
                    </a>
                    <a class="nav-link" href="#message-apis" data-section="message-apis">
                        <i class="bi bi-chat-dots"></i><span>消息功能</span>
                    </a>
                    <a class="nav-link" href="#chat-apis" data-section="chat-apis">
                        <i class="bi bi-window"></i><span>聊天窗口</span>
                    </a>
                    <a class="nav-link" href="#group-apis" data-section="group-apis">
                        <i class="bi bi-people"></i><span>群组管理</span>
                    </a>
                    <a class="nav-link" href="#friend-apis" data-section="friend-apis">
                        <i class="bi bi-person-plus"></i><span>好友管理</span>
                    </a>
                    <a class="nav-link" href="#wechat-apis" data-section="wechat-apis">
                        <i class="bi bi-wechat"></i><span>WeChat扩展</span>
                    </a>
                    <a class="nav-link" href="#message-ops" data-section="message-ops">
                        <i class="bi bi-tools"></i><span>消息操作</span>
                    </a>
                    <a class="nav-link" href="#moments-apis" data-section="moments-apis">
                        <i class="bi bi-heart"></i><span>朋友圈</span>
                    </a>
                    <a class="nav-link" href="#auxiliary-apis" data-section="auxiliary-apis">
                        <i class="bi bi-puzzle"></i><span>辅助功能</span>
                    </a>
                    <a class="nav-link" href="#error-codes" data-section="error-codes">
                        <i class="bi bi-exclamation-triangle"></i><span>错误码</span>
                    </a>
                    <a class="nav-link" href="#examples" data-section="examples">
                        <i class="bi bi-code-slash"></i><span>使用示例</span>
                    </a>
                </nav>
            </div>
        </div>

        <!-- 右侧内容容器 -->
        <div class="content-container">
            <!-- 文档说明区域 -->
            <div class="doc-overview" id="overview">
                <h3><i class="bi bi-book"></i> 概述</h3>
                <h4 class="mb-3">WxAuto HTTP API 文档 v2.0</h4>
                <p class="lead mb-3">功能完整的微信自动化HTTP API系统，支持wxauto和wxautox两个版本</p>

                <div class="row mb-4">
                    <div class="col-md-3 col-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number">95%+</div>
                            <div style="font-size: 0.85em;">功能覆盖率</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number">70+</div>
                            <div style="font-size: 0.85em;">API端点</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number">7</div>
                            <div style="font-size: 0.85em;">功能模块</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number">2</div>
                            <div style="font-size: 0.85em;">支持版本</div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info py-2">
                    <i class="bi bi-info-circle"></i>
                    <strong>版本说明：</strong>
                    本API系统同时支持wxauto（基础版）和wxautox（Plus版），Plus版本功能更加丰富。
                    系统会自动检测当前使用的库版本，并提供相应的功能支持。
                </div>
            </div>

            <!-- 功能特性 -->
            <div class="doc-overview" id="features">
                <h3><i class="bi bi-star"></i> 功能特性</h3>

                <div class="row">
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-chat-dots"></i>
                            </div>
                            <h6 class="mb-2">完整消息支持</h6>
                            <p class="mb-0" style="font-size: 0.85em;">支持文本、图片、文件、语音等多种消息类型的发送和接收</p>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-people"></i>
                            </div>
                            <h6 class="mb-2">群组管理</h6>
                            <p class="mb-0" style="font-size: 0.85em;">完整的群组管理功能，包括成员管理、群设置等</p>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-person-plus"></i>
                            </div>
                            <h6 class="mb-2">好友管理</h6>
                            <p class="mb-0" style="font-size: 0.85em;">好友添加、删除、备注修改等完整好友管理功能</p>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-heart"></i>
                            </div>
                            <h6 class="mb-2">朋友圈功能</h6>
                            <p class="mb-0" style="font-size: 0.85em;">朋友圈浏览、点赞、评论等社交功能（Plus版）</p>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-ear"></i>
                            </div>
                            <h6 class="mb-2">消息监听</h6>
                            <p class="mb-0" style="font-size: 0.85em;">实时监听指定聊天窗口的新消息</p>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 mb-3">
                        <div class="text-center p-3 border rounded">
                            <div style="font-size: 1.5em; color: #07C160; margin-bottom: 8px;">
                                <i class="bi bi-shield-check"></i>
                            </div>
                            <h6 class="mb-2">版本兼容</h6>
                            <p class="mb-0" style="font-size: 0.85em;">同时支持wxauto和wxautox，自动适配功能</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 版本对比 -->
            <div class="doc-overview" id="versions">
                <h3><i class="bi bi-layers"></i> 版本对比</h3>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header bg-success text-white py-2">
                                <h6 class="mb-0"><i class="bi bi-box"></i> wxauto (基础版)</h6>
                            </div>
                            <div class="card-body py-3">
                                <ul class="list-unstyled mb-2" style="font-size: 0.85em;">
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 基础消息发送接收</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 消息监听功能</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 聊天窗口操作</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 文件发送下载</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 基础会话管理</li>
                                </ul>
                                <div class="mt-2">
                                    <span class="version-basic">免费开源</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card h-100">
                            <div class="card-header bg-primary text-white py-2">
                                <h6 class="mb-0"><i class="bi bi-box"></i> wxautox (Plus版)</h6>
                            </div>
                            <div class="card-body py-3">
                                <ul class="list-unstyled mb-2" style="font-size: 0.85em;">
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 包含所有基础功能</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 群组管理功能</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 好友管理功能</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 朋友圈功能</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 高级消息操作</li>
                                    <li class="mb-1"><i class="bi bi-check-circle text-success"></i> 更多自定义功能</li>
                                </ul>
                                <div class="mt-2">
                                    <span class="version-plus">增强版本</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <table class="table table-striped" style="font-size: 0.9em;">
                    <thead>
                        <tr>
                            <th>功能模块</th>
                            <th>wxauto</th>
                            <th>wxautox</th>
                            <th>API端点数</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>基础消息</td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>15+</td>
                        </tr>
                        <tr>
                            <td>消息监听</td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>8</td>
                        </tr>
                        <tr>
                            <td>聊天窗口</td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>8</td>
                        </tr>
                        <tr>
                            <td>群组管理</td>
                            <td><i class="bi bi-x-circle text-danger"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>好友管理</td>
                            <td><i class="bi bi-x-circle text-danger"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>5</td>
                        </tr>
                        <tr>
                            <td>朋友圈</td>
                            <td><i class="bi bi-x-circle text-danger"></i></td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>消息操作</td>
                            <td>部分</td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>8</td>
                        </tr>
                        <tr>
                            <td>辅助功能</td>
                            <td>部分</td>
                            <td><i class="bi bi-check-circle text-success"></i></td>
                            <td>3</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 认证方式 -->
            <div class="doc-overview" id="auth">
                <h3><i class="bi bi-shield-lock"></i> 认证方式</h3>

                <p class="mb-3">所有API请求都需要在HTTP Header中包含API密钥：</p>

                <div class="code-block">
                    <code>X-API-Key: your_api_key_here</code>
                </div>

                <div class="alert alert-warning py-2 mt-3">
                    <i class="bi bi-exclamation-triangle"></i>
                    <strong>安全提示：</strong>
                    请妥善保管您的API密钥，不要在客户端代码中硬编码API密钥。建议使用环境变量或配置文件来管理密钥。
                </div>

                <h5 class="mt-4">API密钥验证示例</h5>
                <div class="code-block">
<pre>curl -X POST http://localhost:5000/api/auth/verify \
  -H "X-API-Key: your-api-key"</pre>
                </div>

                <h6>成功响应：</h6>
                <div class="code-block">
<pre>{
  "code": 0,
  "message": "验证成功",
  "data": {
    "valid": true
  }
}</pre>
                </div>
            </div>

            <!-- API端点区域 -->
            <div class="api-endpoints" id="basic-apis">
                <h3><i class="bi bi-gear"></i> 基础功能</h3>

                <!-- 微信初始化 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-post">POST</span>
                        <code>/api/wechat/initialize</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 微信初始化
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>初始化微信实例，建立与微信的连接。这是使用API的第一步，必须先初始化才能进行其他操作。</p>

                            <h6>请求参数</h6>
                            <p>此接口无需请求参数，只需要在Header中包含有效的API密钥。</p>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X POST http://localhost:5000/api/wechat/initialize \
  -H "X-API-Key: your-api-key"</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "微信初始化成功",
  "data": {
    "status": "initialized",
    "window_name": "微信"
  }
}</pre>
                            </div>

                            <h6>错误码说明</h6>
                            <ul style="font-size: 0.9em;">
                                <li><code>0</code> - 成功</li>
                                <li><code>1001</code> - 微信未启动</li>
                                <li><code>1002</code> - 初始化失败</li>
                            </ul>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="wechat-initialize-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="POST" selected>POST</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/wechat/initialize" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('wechat-initialize-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 获取微信状态 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-get">GET</span>
                        <code>/api/wechat/status</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 获取微信状态
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>获取当前微信连接状态和相关信息，包括连接状态、窗口名称、当前使用的库版本等。</p>

                            <h6>请求参数</h6>
                            <p>此接口无需请求参数。</p>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X GET http://localhost:5000/api/wechat/status \
  -H "X-API-Key: your-api-key"</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "获取状态成功",
  "data": {
    "is_connected": true,
    "window_name": "微信",
    "current_lib": "wxauto"
  }
}</pre>
                            </div>

                            <h6>响应字段说明</h6>
                            <ul style="font-size: 0.9em;">
                                <li><code>is_connected</code> - 是否已连接微信</li>
                                <li><code>window_name</code> - 微信窗口名称</li>
                                <li><code>current_lib</code> - 当前使用的库（wxauto/wxautox）</li>
                            </ul>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="wechat-status-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="GET" selected>GET</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/wechat/status" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('wechat-status-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="api-endpoints" id="message-apis">
                <h3><i class="bi bi-chat-dots"></i> 消息功能</h3>

                <!-- 发送普通消息 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-post">POST</span>
                        <code>/api/message/send</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 发送普通消息
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>向指定联系人或群组发送文本消息，支持@功能和清空输入框选项。</p>

                            <h6>请求参数</h6>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>参数名</th>
                                        <th>类型</th>
                                        <th>必需</th>
                                        <th>说明</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>receiver</td>
                                        <td>string</td>
                                        <td>是</td>
                                        <td>接收者名称（联系人或群组名）</td>
                                    </tr>
                                    <tr>
                                        <td>message</td>
                                        <td>string</td>
                                        <td>是</td>
                                        <td>要发送的消息内容</td>
                                    </tr>
                                    <tr>
                                        <td>at_list</td>
                                        <td>array</td>
                                        <td>否</td>
                                        <td>@的用户列表（仅群组有效）</td>
                                    </tr>
                                    <tr>
                                        <td>clear</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>发送后是否清空输入框，默认true</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X POST http://localhost:5000/api/message/send \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "receiver": "文件传输助手",
    "message": "这是一条测试消息",
    "at_list": ["张三", "李四"],
    "clear": true
  }'</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "消息发送成功",
  "data": {
    "receiver": "文件传输助手",
    "message": "这是一条测试消息",
    "sent_at": "2025-01-24 10:30:15"
  }
}</pre>
                            </div>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="message-send-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="POST" selected>POST</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/message/send" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">请求体 (JSON):</label>
                                        <textarea class="form-control request-body-textarea" rows="6" placeholder="请输入JSON格式的请求体">{
  "receiver": "文件传输助手",
  "message": "这是一条测试消息",
  "at_list": [],
  "clear": true
}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('message-send-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 发送文件 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-post">POST</span>
                        <code>/api/message/send-file</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 发送文件
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>向指定联系人或群组发送文件，支持多种文件类型，可同时发送多个文件。</p>

                            <h6>请求参数</h6>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>参数名</th>
                                        <th>类型</th>
                                        <th>必需</th>
                                        <th>说明</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>receiver</td>
                                        <td>string</td>
                                        <td>是</td>
                                        <td>接收者名称</td>
                                    </tr>
                                    <tr>
                                        <td>file_paths</td>
                                        <td>array</td>
                                        <td>是</td>
                                        <td>文件路径列表</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X POST http://localhost:5000/api/message/send-file \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "receiver": "文件传输助手",
    "file_paths": ["D:/test/document.pdf", "D:/test/image.jpg"]
  }'</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "文件发送成功",
  "data": {
    "receiver": "文件传输助手",
    "files_sent": 2,
    "file_paths": ["D:/test/document.pdf", "D:/test/image.jpg"]
  }
}</pre>
                            </div>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="message-send-file-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="POST" selected>POST</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/message/send-file" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">请求体 (JSON):</label>
                                        <textarea class="form-control request-body-textarea" rows="6" placeholder="请输入JSON格式的请求体">{
  "receiver": "文件传输助手",
  "file_paths": [
    "C:/Users/用户名/Desktop/test.txt",
    "C:/Users/用户名/Documents/image.jpg"
  ]
}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('message-send-file-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 聊天窗口功能 -->
            <div class="api-endpoints" id="chat-apis">
                <h3><i class="bi bi-window"></i> 聊天窗口</h3>

                <!-- 添加监听 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-post">POST</span>
                        <code>/api/message/listen/add</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 添加消息监听
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>为指定的聊天对象添加消息监听，可以实时获取该聊天窗口的新消息。</p>

                            <h6>请求参数</h6>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>参数名</th>
                                        <th>类型</th>
                                        <th>必需</th>
                                        <th>说明</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>who</td>
                                        <td>string</td>
                                        <td>是</td>
                                        <td>要监听的聊天对象名称</td>
                                    </tr>
                                    <tr>
                                        <td>savepic</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>是否保存图片，默认false</td>
                                    </tr>
                                    <tr>
                                        <td>savefile</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>是否保存文件，默认false</td>
                                    </tr>
                                    <tr>
                                        <td>savevoice</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>是否保存语音，默认false</td>
                                    </tr>
                                    <tr>
                                        <td>savevideo</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>是否保存视频（仅Plus版），默认false</td>
                                    </tr>
                                    <tr>
                                        <td>parseurl</td>
                                        <td>boolean</td>
                                        <td>否</td>
                                        <td>是否解析URL（仅Plus版），默认false</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X POST http://localhost:5000/api/message/listen/add \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "who": "测试群",
    "savepic": true,
    "savefile": true,
    "savevoice": false
  }'</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "添加监听成功",
  "data": {
    "who": "测试群"
  }
}</pre>
                            </div>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="message-listen-add-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="POST" selected>POST</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/message/listen/add" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">请求体 (JSON):</label>
                                        <textarea class="form-control request-body-textarea" rows="6" placeholder="请输入JSON格式的请求体">{
  "who": "文件传输助手",
  "savepic": true,
  "savefile": true,
  "savevoice": false,
  "savevideo": false,
  "parseurl": false
}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('message-listen-add-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 获取监听消息 API -->
                <div class="api-endpoint-container">
                    <div class="api-endpoint-header">
                        <span class="method-badge method-get">GET</span>
                        <code>/api/message/listen/get</code>
                        <span class="version-badge version-basic">基础版</span>
                        - 获取监听消息
                    </div>
                    <div class="api-endpoint-content">
                        <!-- 左侧文档说明 -->
                        <div class="api-doc-section">
                            <h5>接口说明</h5>
                            <p>获取已监听聊天对象的新消息。可以获取所有监听对象的消息，也可以指定特定对象。</p>

                            <h6>请求参数</h6>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>参数名</th>
                                        <th>类型</th>
                                        <th>必需</th>
                                        <th>说明</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>who</td>
                                        <td>string</td>
                                        <td>否</td>
                                        <td>指定聊天对象，不指定则获取所有</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h6>请求示例</h6>
                            <div class="code-block">
<pre>curl -X GET "http://localhost:5000/api/message/listen/get?who=测试群" \
  -H "X-API-Key: your-api-key"</pre>
                            </div>

                            <h6>响应格式</h6>
                            <div class="code-block">
<pre>{
  "code": 0,
  "message": "获取成功",
  "data": {
    "messages": {
      "测试群": [
        {
          "type": "text",
          "content": "这是一条消息",
          "sender": "张三",
          "id": "msg_001",
          "mtype": null,
          "sender_remark": null
        }
      ]
    }
  }
}</pre>
                            </div>
                        </div>

                        <!-- 右侧测试工具 -->
                        <div class="api-test-section">
                            <div class="api-tester" id="message-listen-get-tester">
                                <div class="tester-header">
                                    <i class="bi bi-play-circle"></i> API接口测试
                                </div>
                                <div class="tester-body">
                                    <div class="row mb-2">
                                        <div class="col-md-6">
                                            <label class="form-label">服务器地址:</label>
                                            <input type="text" class="form-control base-url-input" value="http://localhost:5000">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">API Key:</label>
                                            <input type="text" class="form-control api-key-input" placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <div class="row mb-2">
                                        <div class="col-md-3">
                                            <label class="form-label">请求方法:</label>
                                            <select class="form-select method-select">
                                                <option value="GET" selected>GET</option>
                                            </select>
                                        </div>
                                        <div class="col-md-9">
                                            <label class="form-label">接口路径:</label>
                                            <input type="text" class="form-control endpoint-input" value="/api/message/listen/get" readonly>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">查询参数:</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label class="form-label">聊天对象 (who):</label>
                                                <input type="text" class="form-control" id="listen-get-who" placeholder="可选，不填则获取所有">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <button type="button" class="test-button" onclick="sendApiRequest('message-listen-get-tester')">
                                            发送请求
                                        </button>
                                    </div>
                                    <div class="response-section" style="display: none;">
                                        <div class="response-header">响应结果:</div>
                                        <div class="response-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 群组管理功能 -->
            <div class="api-endpoints" id="group-apis">
                <h3><i class="bi bi-people"></i> 群组管理</h3>
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i>
                    群组管理功能仅在wxautox（Plus版）中可用。
                </div>
            </div>

            <!-- 好友管理功能 -->
            <div class="api-endpoints" id="friend-apis">
                <h3><i class="bi bi-person-plus"></i> 好友管理</h3>
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i>
                    好友管理功能仅在wxautox（Plus版）中可用。
                </div>
            </div>

            <!-- WeChat扩展功能 -->
            <div class="api-endpoints" id="wechat-apis">
                <h3><i class="bi bi-wechat"></i> WeChat扩展</h3>
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i>
                    WeChat扩展功能正在开发中。
                </div>
            </div>

            <!-- 消息操作功能 -->
            <div class="api-endpoints" id="message-ops">
                <h3><i class="bi bi-tools"></i> 消息操作</h3>
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i>
                    消息操作功能正在开发中，将包括消息撤回、转发等功能。
                </div>
            </div>

            <!-- 朋友圈功能 -->
            <div class="api-endpoints" id="moments-apis">
                <h3><i class="bi bi-heart"></i> 朋友圈</h3>
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i>
                    朋友圈功能仅在wxautox（Plus版）中可用。
                </div>
            </div>

            <!-- 辅助功能 -->
            <div class="api-endpoints" id="auxiliary-apis">
                <h3><i class="bi bi-puzzle"></i> 辅助功能</h3>
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i>
                    辅助功能正在开发中。
                </div>
            </div>

            <!-- 错误码说明 -->
            <div class="doc-overview" id="error-codes">
                <h3><i class="bi bi-exclamation-triangle"></i> 错误码说明</h3>

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>错误码</th>
                            <th>说明</th>
                            <th>解决方案</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>0</code></td>
                            <td>成功</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td><code>1001</code></td>
                            <td>微信未启动</td>
                            <td>请先启动微信客户端</td>
                        </tr>
                        <tr>
                            <td><code>1002</code></td>
                            <td>初始化失败</td>
                            <td>检查微信是否正常运行</td>
                        </tr>
                        <tr>
                            <td><code>2001</code></td>
                            <td>联系人不存在</td>
                            <td>检查联系人名称是否正确</td>
                        </tr>
                        <tr>
                            <td><code>2002</code></td>
                            <td>消息发送失败</td>
                            <td>检查网络连接和微信状态</td>
                        </tr>
                        <tr>
                            <td><code>3001</code></td>
                            <td>文件不存在</td>
                            <td>检查文件路径是否正确</td>
                        </tr>
                        <tr>
                            <td><code>4001</code></td>
                            <td>功能不支持</td>
                            <td>当前版本不支持此功能</td>
                        </tr>
                        <tr>
                            <td><code>5001</code></td>
                            <td>API密钥无效</td>
                            <td>检查API密钥是否正确</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 使用示例 -->
            <div class="doc-overview" id="examples">
                <h3><i class="bi bi-code-slash"></i> 使用示例</h3>

                <h5>Python示例</h5>
                <div class="code-block">
<pre>import requests

API_BASE = "http://localhost:5000"
API_KEY = "your-api-key"

headers = {
    "X-API-Key": API_KEY,
    "Content-Type": "application/json"
}

# 初始化微信
response = requests.post(f"{API_BASE}/api/wechat/initialize", headers=headers)
print(response.json())

# 发送消息
data = {
    "receiver": "文件传输助手",
    "message": "Hello from Python!"
}
response = requests.post(f"{API_BASE}/api/message/send", json=data, headers=headers)
print(response.json())</pre>
                </div>

                <h5>JavaScript示例</h5>
                <div class="code-block">
<pre>class WxAutoAPI {
    constructor(baseUrl, apiKey) {
        this.baseUrl = baseUrl;
        this.headers = {
            'X-API-Key': apiKey,
            'Content-Type': 'application/json'
        };
    }

    async initialize() {
        const response = await fetch(`${this.baseUrl}/api/wechat/initialize`, {
            method: 'POST',
            headers: this.headers
        });
        return response.json();
    }

    async sendMessage(receiver, message) {
        const response = await fetch(`${this.baseUrl}/api/message/send`, {
            method: 'POST',
            headers: this.headers,
            body: JSON.stringify({ receiver, message })
        });
        return response.json();
    }
}

// 使用示例
const api = new WxAutoAPI('http://localhost:5000', 'your-api-key');
api.initialize().then(() => {
    return api.sendMessage('文件传输助手', 'Hello from JavaScript!');
}).then(result => {
    console.log(result);
});</pre>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 页面初始化
        document.addEventListener('DOMContentLoaded', function() {
            initNavigation();
            initSidebar();
            initApiTester();
            loadContent();
        });

        // 初始化导航功能 - 完全重写版本
        function initNavigation() {
            console.log('🚀 开始初始化导航功能');

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.doc-overview, .api-endpoints');

            console.log('找到导航链接数量:', navLinks.length);
            console.log('找到区域数量:', sections.length);

            if (navLinks.length === 0 || sections.length === 0) {
                console.error('❌ 未找到导航链接或区域');
                return;
            }

            // 设置活动导航状态的函数
            function setActiveNavigation(sectionId) {
                console.log('🎯 设置活动导航:', sectionId);
                navLinks.forEach(link => {
                    if (link.getAttribute('data-section') === sectionId) {
                        link.classList.add('active');
                        console.log('✅ 激活导航:', sectionId);
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            // 导航链接点击事件
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section');
                    console.log('🖱️ 点击导航:', sectionId);

                    // 立即更新导航状态
                    setActiveNavigation(sectionId);

                    // 滚动到目标区域
                    const targetSection = document.getElementById(sectionId);
                    if (targetSection) {
                        targetSection.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }

                    // 移动端关闭侧边栏
                    if (window.innerWidth <= 768) {
                        closeMobileSidebar();
                    }
                });
            });

            // 使用Intersection Observer API进行滚动检测
            const observerOptions = {
                root: null,
                rootMargin: '-20% 0px -60% 0px', // 调整触发区域：视口上20%到下40%
                threshold: [0, 0.1, 0.5] // 多个阈值，提高检测精度
            };

            const observer = new IntersectionObserver((entries) => {
                console.log('📊 Intersection Observer 触发, 条目数:', entries.length);

                // 获取所有当前可见的区域
                const allVisibleSections = [];
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    if (rect.top < window.innerHeight && rect.bottom > 0) {
                        allVisibleSections.push({
                            element: section,
                            id: section.getAttribute('id'),
                            top: rect.top,
                            intersectionRatio: Math.max(0, Math.min(window.innerHeight - rect.top, rect.height, rect.bottom) / rect.height)
                        });
                    }
                });

                console.log('所有可见区域:', allVisibleSections.map(s => `${s.id}(${s.intersectionRatio.toFixed(2)})`));

                if (allVisibleSections.length > 0) {
                    // 选择可见度最高的区域，或者最靠近视口顶部的区域
                    let bestSection = allVisibleSections[0];
                    for (let section of allVisibleSections) {
                        if (section.intersectionRatio > bestSection.intersectionRatio ||
                            (section.intersectionRatio === bestSection.intersectionRatio && section.top < bestSection.top)) {
                            bestSection = section;
                        }
                    }

                    console.log('🎯 Observer选择区域:', bestSection.id, '可见度:', bestSection.intersectionRatio.toFixed(2));
                    setActiveNavigation(bestSection.id);
                }
            }, observerOptions);

            // 观察所有区域
            sections.forEach(section => {
                observer.observe(section);
                console.log('👀 开始观察区域:', section.getAttribute('id'));
            });

            // 备用滚动检测（简化版本）
            let scrollTimeout;
            function fallbackScrollDetection() {
                if (scrollTimeout) clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    console.log('🔄 备用滚动检测');

                    const scrollTop = window.pageYOffset;
                    const triggerPoint = scrollTop + 200; // 滚动位置 + 200px

                    let activeSection = null;

                    // 从上到下检查每个区域
                    for (let i = 0; i < sections.length; i++) {
                        const section = sections[i];
                        const rect = section.getBoundingClientRect();
                        const sectionTop = scrollTop + rect.top;
                        const sectionBottom = sectionTop + rect.height;
                        const sectionId = section.getAttribute('id');

                        console.log(`检查区域 ${sectionId}: top=${sectionTop}, bottom=${sectionBottom}, trigger=${triggerPoint}`);

                        // 如果触发点在这个区域内
                        if (triggerPoint >= sectionTop && triggerPoint <= sectionBottom) {
                            activeSection = sectionId;
                            console.log(`✓ 触发点在区域内: ${sectionId}`);
                            break;
                        }
                        // 如果触发点超过了这个区域，但还没到下一个区域
                        else if (triggerPoint >= sectionTop) {
                            activeSection = sectionId;
                            console.log(`候选区域: ${sectionId}`);
                        }
                    }

                    if (activeSection) {
                        console.log('🎯 备用检测选择区域:', activeSection);
                        setActiveNavigation(activeSection);
                    }
                }, 100);
            }

            // 启用备用滚动检测
            window.addEventListener('scroll', fallbackScrollDetection);
            console.log('✅ 滚动事件监听器已添加');

            // 初始化时设置第一个导航为活动状态
            if (navLinks.length > 0) {
                const firstSection = navLinks[0].getAttribute('data-section');
                setActiveNavigation(firstSection);
                console.log('🎯 初始化激活第一个导航:', firstSection);
            }

            console.log('✅ 导航功能初始化完成');
        }

        // 初始化侧边栏功能
        function initSidebar() {
            // 桌面端切换按钮
            const desktopToggle = document.getElementById('sidebarToggleDesktop');
            const sidebarContainer = document.getElementById('sidebarContainer');
            
            if (desktopToggle) {
                desktopToggle.addEventListener('click', function() {
                    sidebarContainer.classList.toggle('collapsed');
                });
            }
            
            // 移动端切换按钮
            const mobileToggle = document.getElementById('sidebarToggle');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (mobileToggle) {
                mobileToggle.addEventListener('click', function() {
                    sidebarContainer.classList.add('show');
                    overlay.classList.add('show');
                });
            }
            
            if (overlay) {
                overlay.addEventListener('click', closeMobileSidebar);
            }
        }

        // 关闭移动端侧边栏
        function closeMobileSidebar() {
            const sidebarContainer = document.getElementById('sidebarContainer');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebarContainer.classList.remove('show');
            overlay.classList.remove('show');
        }

        // 初始化API测试工具
        function initApiTester() {
            const baseUrl = window.location.origin;
            const apiKey = '123456aA';

            // 填充所有URL和API Key字段
            document.querySelectorAll('.base-url-input').forEach(input => {
                input.value = baseUrl;
            });

            document.querySelectorAll('.api-key-input').forEach(input => {
                input.value = apiKey;
            });
        }

        // 发送API请求
        async function sendApiRequest(testerId) {
            const tester = document.getElementById(testerId);
            const button = tester.querySelector('.test-button');
            const responseSection = tester.querySelector('.response-section');
            const responseContent = tester.querySelector('.response-content');

            // 获取表单数据
            const baseUrl = tester.querySelector('.base-url-input').value;
            const apiKey = tester.querySelector('.api-key-input').value;
            const method = tester.querySelector('.method-select').value;
            const endpoint = tester.querySelector('.endpoint-input').value;
            const requestBody = tester.querySelector('.request-body-textarea')?.value;

            // 处理查询参数
            let fullUrl = baseUrl + endpoint;
            if (method === 'GET') {
                const queryParams = new URLSearchParams();

                // 查找所有查询参数输入框
                const queryInputs = tester.querySelectorAll('input[id*="-who"], input[id*="-nickname"], input[id*="-speed"], input[id*="-interval"], input[id*="-n"], input[id*="-timeout"]');
                queryInputs.forEach(input => {
                    if (input.value.trim()) {
                        const paramName = input.id.split('-').pop();
                        queryParams.append(paramName, input.value.trim());
                    }
                });

                // 特殊处理监听消息获取的who参数
                if (testerId === 'message-listen-get-tester') {
                    const whoInput = tester.querySelector('#listen-get-who');
                    if (whoInput && whoInput.value.trim()) {
                        queryParams.append('who', whoInput.value.trim());
                    }
                }

                if (queryParams.toString()) {
                    fullUrl += '?' + queryParams.toString();
                }
            }

            // 设置请求头
            const headers = {
                'X-API-Key': apiKey,
                'Content-Type': 'application/json'
            };

            // 构建请求配置
            const requestConfig = {
                method: method,
                headers: headers
            };

            // 如果有请求体且不是GET请求，添加body
            if (requestBody && method !== 'GET') {
                try {
                    JSON.parse(requestBody); // 验证JSON格式
                    requestConfig.body = requestBody;
                } catch (e) {
                    responseContent.textContent = `错误: 请求体不是有效的JSON格式\n详细错误: ${e.message}\n\n请检查JSON语法，确保：\n1. 字符串使用双引号\n2. 属性名使用双引号\n3. 数组和对象的语法正确\n4. 没有多余的逗号`;
                    responseContent.className = 'response-content response-error';
                    responseSection.style.display = 'block';
                    return;
                }
            }

            // 显示加载状态
            button.disabled = true;
            button.innerHTML = '<span class="loading-spinner"></span> 发送中...';
            responseSection.style.display = 'block';
            responseContent.textContent = '正在发送请求...';
            responseContent.className = 'response-content';

            try {
                // 发送请求
                const response = await fetch(fullUrl, requestConfig);
                const responseData = await response.json();

                // 构建响应信息
                const responseInfo = {
                    status: response.status,
                    statusText: response.statusText,
                    headers: Object.fromEntries(response.headers.entries()),
                    data: responseData
                };

                // 显示响应
                responseContent.textContent = JSON.stringify(responseInfo, null, 2);
                responseContent.className = response.ok ?
                    'response-content response-success' :
                    'response-content response-error';

            } catch (error) {
                // 显示错误
                responseContent.textContent = `请求失败: ${error.message}`;
                responseContent.className = 'response-content response-error';
            } finally {
                // 恢复按钮状态
                button.disabled = false;
                button.innerHTML = '发送请求';
            }
        }

        // 加载内容
        function loadContent() {
            // 页面加载完成后，所有内容都已可见，无需额外操作
            console.log('页面内容加载完成');
        }
    </script>
</body>
</html>
