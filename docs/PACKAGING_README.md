# 打包说明

本文档说明如何将项目打包为Windows可执行程序，以及打包后的使用方法。

## 打包方法

### 方法一：使用批处理文件（推荐）

1. 双击运行 `build_app.bat`
2. 等待打包完成
3. 打包完成后，可执行文件将位于 `dist/wxauto_http_api` 目录下

### 方法二：使用Python脚本

1. 打开命令提示符或PowerShell
2. 切换到项目根目录
3. 运行以下命令：
   ```
   python build_app.py
   ```
4. 等待打包完成
5. 打包完成后，可执行文件将位于 `dist/wxauto_http_api` 目录下

### 高级选项

- 调试模式：`python build_app.py --debug`
  - 生成带控制台窗口的可执行文件，方便查看日志
  - 输出目录：`dist/wxauto_http_api_debug`

- 单文件模式：`python build_app.py --onefile`
  - 生成单个可执行文件，而不是文件夹
  - 注意：单文件模式可能会导致启动速度变慢，且可能存在兼容性问题

## 打包后的使用方法

1. 将 `dist/wxauto_http_api` 目录复制到目标计算机上的任意位置
2. 启动方式：
   - **启动UI界面**：双击运行 `wxauto_http_api.exe` 或 `start_ui.bat`
   - **直接启动API服务**：双击运行 `start_api_packaged.bat`
3. 微信初始化：
   - 通过UI界面，API服务启动后会自动尝试初始化微信
   - 如果自动初始化失败，可以双击运行 `initialize_wechat.bat` 手动初始化
4. 如需使用wxautox库，可通过UI界面的"安装wxautox"按钮进行安装

## 注意事项

1. 打包后的程序包含wxauto库，但不包含wxautox库
2. wxautox库需要单独安装，可通过UI界面进行安装
3. 打包后的程序会自动创建必要的目录和配置文件
4. 如果遇到问题，可尝试使用调试模式打包，查看详细日志

## 常见问题

### 1. 程序无法启动

可能原因：
- 缺少必要的系统依赖
- 权限不足
- 路径中包含特殊字符

解决方法：
- 尝试以管理员身份运行
- 将程序移动到路径不包含特殊字符的目录
- 使用调试模式打包，查看详细错误信息

### 2. wxauto库无法正常工作

可能原因：
- 路径问题
- 缺少必要的系统依赖

解决方法：
- 确保程序运行目录下存在wxauto文件夹
- 检查是否安装了必要的系统依赖（如pywin32）

### 3. wxautox库安装失败

可能原因：
- 网络问题
- 权限不足
- wheel文件不兼容

解决方法：
- 确保wheel文件位于程序运行目录下
- 尝试以管理员身份运行程序
- 手动安装wheel文件：`pip install wxautox-xxx.whl`

### 4. API服务无法启动

可能原因：
- 端口被占用
- 权限不足
- 路径问题

解决方法：
- 检查端口是否被占用，可以尝试修改配置文件中的端口号
- 尝试以管理员身份运行
- 查看日志文件，了解详细错误信息

### 5. UI启动后无法启动API服务

可能原因：
- API服务已经在运行
- 互斥锁问题

解决方法：
- 检查是否已有API服务在运行，可以使用任务管理器查看
- 尝试使用`--no-mutex-check`参数启动API服务：
  ```
  wxauto_http_api.exe --service api --no-mutex-check
  ```
